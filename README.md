This is adapted from the source code to Jon Barron's public academic website: https://jonbarron.info/.